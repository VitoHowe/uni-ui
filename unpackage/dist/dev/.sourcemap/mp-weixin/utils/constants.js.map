{"version":3,"file":"constants.js","sources":["utils/constants.js"],"sourcesContent":["// 环境配置\nconst ENV_CONFIG = {\n  development: {\n    BASE_URL: 'http://127.0.0.1:3001/api'\n  },\n  production: {\n    BASE_URL: 'https://wxnode.mayday.qzz.io/api'\n  }\n}\n\nconst getProcessEnv = (key) => {\n  if (typeof process === 'undefined' || !process.env) {\n    return ''\n  }\n  return process.env[key] || ''\n}\n\nconst normalizeBaseUrl = (url = '') => {\n  if (!url) return ''\n  return url.replace(/\\/+$/, '')\n}\n\nconst resolveEnvironment = () => {\n  return getProcessEnv('NODE_ENV') === 'production' ? 'production' : 'development'\n}\n\nconst resolveEnvBaseUrl = () => {\n  const envValue =\n    getProcessEnv('UNI_API_BASE_URL') ||\n    getProcessEnv('VITE_API_BASE_URL') ||\n    getProcessEnv('API_BASE_URL')\n\n  return normalizeBaseUrl(envValue)\n}\n\nconst currentEnv = resolveEnvironment()\nconst envBaseUrl = resolveEnvBaseUrl()\nconst fallbackEnv = currentEnv\nconst fallbackBaseUrl = normalizeBaseUrl(ENV_CONFIG[fallbackEnv].BASE_URL)\nconst resolvedBaseUrl = envBaseUrl || fallbackBaseUrl\nconst resolvedSource = envBaseUrl ? 'env' : `default:${fallbackEnv}`\n\nif (!envBaseUrl) {\n  console.log(`[API_CONFIG] 未配置 UNI_API_BASE_URL，使用 ${fallbackEnv} 默认地址: ${resolvedBaseUrl}`)\n}\n\nif (currentEnv === 'production' && !envBaseUrl) {\n  console.warn('[API_CONFIG] 当前 NODE_ENV=production，但未配置 UNI_API_BASE_URL，已回退到 production 默认地址')\n}\n\r\n// API配置常量\r\nexport const API_CONFIG = {\n  // 基础API地址 - 根据环境自动切换\n  BASE_URL: resolvedBaseUrl,\n\n  // 当前环境与配置来源，便于调试页面排查\n  ENV: currentEnv,\n  BASE_URL_SOURCE: resolvedSource,\n  \r\n  // 超时时间 (毫秒)\r\n  TIMEOUT: 10000,\r\n  \r\n  // Token过期前刷新时间 (毫秒) - 提前5分钟刷新\r\n  TOKEN_REFRESH_THRESHOLD: 5 * 60 * 1000,\r\n  \r\n  // 最大重试次数\r\n  MAX_RETRY_COUNT: 3\r\n}\r\n\r\n// API端点路径\r\nexport const API_ENDPOINTS = {\r\n  // 认证相关\r\n  AUTH: {\r\n    LOGIN: '/auth/login',           // 微信登录\r\n    REFRESH: '/auth/refresh',       // 刷新Token\r\n    PROFILE: '/auth/profile',       // 获取用户信息\r\n    LOGOUT: '/auth/logout'          // 退出登录\r\n  },\r\n  \r\n  // 单词书管理\r\n  WORD_BOOKS: {\r\n    LIST: '/word-books',\r\n    WORDS: (bookId) => `/word-books/${bookId}/words`,\r\n  },\r\n  \r\n  // 题库管理\r\n  QUESTIONS: {\r\n    BANKS: '/questions/banks',      // 题库列表\r\n    BANK_DETAIL: '/questions/banks',// 题库详情 /{id}\r\n  },\r\n  \r\n  SUBJECTS: {\n    LIST: '/subjects',\n    BANKS: (subjectId) => `/subjects/${subjectId}/banks`,\n    CHAPTERS: (subjectId) => `/subjects/${subjectId}/chapters`,\n  },\n\n  ESSAYS: {\n    SUBJECT_ORGS: (subjectId) => `/subjects/${subjectId}/essay-orgs`,\n    SUBJECT_LIST: (subjectId) => `/subjects/${subjectId}/essays`,\n    SUBJECT_CHAPTER_LIST: (subjectId, chapterId) =>\n      `/subjects/${subjectId}/chapters/${chapterId}/essays`,\n    DETAIL: (essayId) => `/essays/${essayId}`,\n  },\n  \r\n  // 文件管理\r\n  FILES: {\r\n    UPLOAD: '/files/upload',        // 文件上传\r\n  },\r\n}\r\n\r\n// 本地存储Key\r\nexport const STORAGE_KEYS = {\r\n  ACCESS_TOKEN: 'access_token',\r\n  REFRESH_TOKEN: 'refresh_token',\r\n  USER_INFO: 'user_info',\r\n  LOGIN_STATE: 'login_state',\r\n  TOKEN_EXPIRES_AT: 'token_expires_at',\r\n  SELECTED_SUBJECT: 'selected_subject'\r\n}\r\n\r\n// HTTP状态码\r\nexport const HTTP_STATUS = {\r\n  OK: 200,\r\n  BAD_REQUEST: 400,\r\n  UNAUTHORIZED: 401,\r\n  FORBIDDEN: 403,\r\n  NOT_FOUND: 404,\r\n  INTERNAL_SERVER_ERROR: 500\r\n}\r\n\r\n// 错误类型\r\nexport const ERROR_TYPES = {\r\n  NETWORK_ERROR: 'NETWORK_ERROR',\r\n  TIMEOUT_ERROR: 'TIMEOUT_ERROR',\r\n  AUTH_ERROR: 'AUTH_ERROR',\r\n  BUSINESS_ERROR: 'BUSINESS_ERROR',\r\n  UNKNOWN_ERROR: 'UNKNOWN_ERROR'\r\n}\r\n\r\n// 用户角色\r\nexport const USER_ROLES = {\r\n  ADMIN: 1,    // 管理员\r\n  USER: 2      // 普通用户\r\n}\r\n\r\n// 用户状态\r\nexport const USER_STATUS = {\r\n  DISABLED: 0, // 禁用\r\n  ENABLED: 1   // 启用\r\n}\r\n\r\n// 题目类型\r\nexport const QUESTION_TYPES = {\r\n  SINGLE: 'single',      // 单选题\r\n  MULTIPLE: 'multiple',  // 多选题\r\n  JUDGE: 'judge',        // 判断题\r\n  FILL: 'fill',          // 填空题\r\n  ESSAY: 'essay'         // 简答题\r\n}\r\n\r\n// 难度等级\r\nexport const DIFFICULTY_LEVELS = {\r\n  EASY: 1,     // 简单\r\n  MEDIUM: 2,   // 中等\r\n  HARD: 3      // 困难\r\n}\r\n\r\n// 文件解析状态\r\nexport const FILE_PARSE_STATUS = {\r\n  PENDING: 'pending',     // 待解析\r\n  PARSING: 'parsing',     // 解析中\r\n  COMPLETED: 'completed', // 解析完成\r\n  FAILED: 'failed'        // 解析失败\r\n}\r\n\r\n// 默认配置\r\nexport const DEFAULT_CONFIG = {\r\n  // 分页默认参数\r\n  PAGINATION: {\r\n    PAGE: 1,\r\n    LIMIT: 20,\r\n    MAX_LIMIT: 100\r\n  },\r\n  \r\n  // 文件上传限制\r\n  FILE_UPLOAD: {\r\n    MAX_SIZE: 50 * 1024 * 1024, // 50MB\r\n    ALLOWED_TYPES: ['application/pdf']\r\n  }\r\n}\r\n"],"names":["uni"],"mappings":";;AACA,MAAM,aAAa;AAAA,EACjB,aAAa;AAAA,IACX,UAAU;AAAA,EACX;AAAA,EACD,YAAY;AAAA,IACV,UAAU;AAAA,EACX;AACH;AAEA,MAAM,gBAAgB,CAAC,QAAQ;AAC7B,MAAI,OAAO,YAAY,eAAe,CAAC,QAAQ,KAAK;AAClD,WAAO;AAAA,EACR;AACD,SAAO,QAAQ,IAAI,GAAG,KAAK;AAC7B;AAEA,MAAM,mBAAmB,CAAC,MAAM,OAAO;AACrC,MAAI,CAAC;AAAK,WAAO;AACjB,SAAO,IAAI,QAAQ,QAAQ,EAAE;AAC/B;AAEA,MAAM,qBAAqB,MAAM;AAC/B,SAAO,cAAc,UAAU,MAAM,eAAe,eAAe;AACrE;AAEA,MAAM,oBAAoB,MAAM;AAC9B,QAAM,WACJ,cAAc,kBAAkB,KAChC,cAAc,mBAAmB,KACjC,cAAc,cAAc;AAE9B,SAAO,iBAAiB,QAAQ;AAClC;AAEA,MAAM,aAAa,mBAAoB;AACvC,MAAM,aAAa,kBAAmB;AACtC,MAAM,cAAc;AACpB,MAAM,kBAAkB,iBAAiB,WAAW,WAAW,EAAE,QAAQ;AACzE,MAAM,kBAAkB,cAAc;AACtC,MAAM,iBAAiB,aAAa,QAAQ,WAAW,WAAW;AAElE,IAAI,CAAC,YAAY;AACfA,sBAAY,MAAA,OAAA,4BAAA,wCAAwC,WAAW,UAAU,eAAe,EAAE;AAC5F;AAEA,IAAI,eAAe,gBAAgB,CAAC,YAAY;AAC9CA,gBAAAA,MAAa,MAAA,QAAA,4BAAA,gFAAgF;AAC/F;AAGY,MAAC,aAAa;AAAA;AAAA,EAExB,UAAU;AAAA;AAAA,EAGV,KAAK;AAAA,EACL,iBAAiB;AAAA;AAAA,EAGjB,SAAS;AAAA;AAAA,EAGT,yBAAyB,IAAI,KAAK;AAAA;AAAA,EAGlC,iBAAiB;AACnB;AAGY,MAAC,gBAAgB;AAAA;AAAA,EAE3B,MAAM;AAAA,IACJ,OAAO;AAAA;AAAA,IACP,SAAS;AAAA;AAAA,IACT,SAAS;AAAA;AAAA,IACT,QAAQ;AAAA;AAAA,EACT;AAAA;AAAA,EAGD,YAAY;AAAA,IACV,MAAM;AAAA,IACN,OAAO,CAAC,WAAW,eAAe,MAAM;AAAA,EACzC;AAAA;AAAA,EAGD,WAAW;AAAA,IACT,OAAO;AAAA;AAAA,IACP,aAAa;AAAA;AAAA,EACd;AAAA,EAED,UAAU;AAAA,IACR,MAAM;AAAA,IACN,OAAO,CAAC,cAAc,aAAa,SAAS;AAAA,IAC5C,UAAU,CAAC,cAAc,aAAa,SAAS;AAAA,EAChD;AAAA,EAED,QAAQ;AAAA,IACN,cAAc,CAAC,cAAc,aAAa,SAAS;AAAA,IACnD,cAAc,CAAC,cAAc,aAAa,SAAS;AAAA,IACnD,sBAAsB,CAAC,WAAW,cAChC,aAAa,SAAS,aAAa,SAAS;AAAA,IAC9C,QAAQ,CAAC,YAAY,WAAW,OAAO;AAAA,EACxC;AAAA;AAAA,EAGD,OAAO;AAAA,IACL,QAAQ;AAAA;AAAA,EACT;AACH;AAGY,MAAC,eAAe;AAAA,EAC1B,cAAc;AAAA,EACd,eAAe;AAAA,EACf,WAAW;AAAA,EACX,aAAa;AAAA,EACb,kBAAkB;AAAA,EAClB,kBAAkB;AACpB;AAGY,MAAC,cAAc;AAAA,EACzB,IAAI;AAAA,EACJ,aAAa;AAAA,EACb,cAAc;AAAA,EACd,WAAW;AAAA,EACX,WAAW;AAAA,EACX,uBAAuB;AACzB;AAGY,MAAC,cAAc;AAAA,EACzB,eAAe;AAAA,EACf,eAAe;AAAA,EACf,YAAY;AAAA,EACZ,gBAAgB;AAAA,EAChB,eAAe;AACjB;;;;;;"}