{"version":3,"file":"essayParser.js","sources":["pkg-exam/utils/essayParser.js"],"sourcesContent":["import MarkdownIt from 'markdown-it'\nimport katex from 'katex'\n\nconst markdown = new MarkdownIt({\n  html: true,\n  linkify: true,\n  breaks: true,\n  typographer: true\n})\n\nconst ESCAPED_DOLLAR_TOKEN = '__WX_ESSAY_ESCAPED_DOLLAR__'\n\nconst sanitizeRenderedHtml = (html) => {\n  if (!html) return ''\n\n  let output = html\n  output = output.replace(/<script[\\s\\S]*?>[\\s\\S]*?<\\/script>/gi, '')\n  output = output.replace(/<style[\\s\\S]*?>[\\s\\S]*?<\\/style>/gi, '')\n  output = output.replace(/<(iframe|object|embed)[\\s\\S]*?>[\\s\\S]*?<\\/\\1>/gi, '')\n  output = output.replace(/\\son\\w+=(['\"]).*?\\1/gi, '')\n  output = output.replace(/\\son\\w+=\\S+/gi, '')\n  output = output.replace(/(href|src)=[\"']\\s*javascript:[^\"']*[\"']/gi, '$1=\"#\"')\n\n  return output\n}\n\nconst stripImageSizeAttributes = (html) => {\n  if (!html) return ''\n  return html.replace(/<img\\b([^>]*)>/gi, (match, attrs = '') => {\n    const cleanedAttrs = attrs\n      .replace(/\\s(?:width|height)\\s*=\\s*([\"']).*?\\1/gi, '')\n      .replace(/\\s(?:width|height)\\s*=\\s*[^>\\s]+/gi, '')\n    return `<img${cleanedAttrs}>`\n  })\n}\n\nconst applyInlineStyle = (html, tagName, styleText) => {\n  const pattern = new RegExp(`<${tagName}([^>]*)>`, 'gi')\n  return html.replace(pattern, (match, attrs) => {\n    const attrText = attrs || ''\n    if (/style\\s*=/.test(attrText)) {\n      return `<${tagName}${attrText.replace(/style\\s*=\\s*([\"'])(.*?)\\1/i, (styleMatch, quote, styleValue) => {\n        const nextStyle = styleValue.trim().endsWith(';')\n          ? `${styleValue}${styleText}`\n          : `${styleValue};${styleText}`\n        return `style=${quote}${nextStyle}${quote}`\n      })}>`\n    }\n    return `<${tagName}${attrText} style=\"${styleText}\">`\n  })\n}\n\nconst enhanceTypography = (html) => {\n  if (!html) return ''\n  let output = html\n  output = applyInlineStyle(output, 'h1', 'font-size:26px;line-height:1.4;margin:18px 0 12px;color:#0f172a;font-weight:700;')\n  output = applyInlineStyle(output, 'h2', 'font-size:22px;line-height:1.4;margin:16px 0 10px;color:#0f172a;font-weight:700;')\n  output = applyInlineStyle(output, 'h3', 'font-size:19px;line-height:1.45;margin:14px 0 8px;color:#0f172a;font-weight:700;')\n  output = applyInlineStyle(output, 'p', 'font-size:16px;line-height:1.8;color:#1f2937;margin:10px 0;word-break:break-word;')\n  output = applyInlineStyle(output, 'li', 'font-size:15px;line-height:1.75;color:#1f2937;word-break:break-word;')\n  output = applyInlineStyle(output, 'blockquote', 'margin:14px 0;padding:12px 14px;border-left:4px solid #14b8a6;background:#f0fdfa;color:#0f766e;border-radius:8px;')\n  return output\n}\n\nconst decodeHtmlEntities = (value = '') => {\n  return String(value || '')\n    .replace(/&nbsp;/gi, ' ')\n    .replace(/&lt;/gi, '<')\n    .replace(/&gt;/gi, '>')\n    .replace(/&amp;/gi, '&')\n    .replace(/&#39;/gi, \"'\")\n    .replace(/&quot;/gi, '\"')\n}\n\nconst estimateLineWidthUnits = (line = '') => {\n  let units = 0\n  for (const char of String(line || '')) {\n    if (char === '\\t') {\n      units += 2\n      continue\n    }\n    const codePoint = char.codePointAt(0) || 0\n    // ASCII 字符按 1 单位，非 ASCII 近似按 2 单位估算，保证窄屏仍能完整容纳。\n    units += codePoint <= 0x7f ? 1 : 2\n  }\n  return units\n}\n\nconst getPreBlockScaleFontSize = (codeBlockHtml = '') => {\n  const plainText = decodeHtmlEntities(codeBlockHtml.replace(/<[^>]*>/g, ''))\n  const lines = plainText.split('\\n')\n  const maxLineUnits = lines.reduce((max, line) => Math.max(max, estimateLineWidthUnits(line)), 0)\n  if (!maxLineUnits) return 13\n\n  const BASE_FONT_SIZE = 13\n  const MIN_FONT_SIZE = 5\n  const SAFE_INNER_WIDTH_PX = 248\n  const MONO_CHAR_WIDTH_RATIO = 0.62\n  const estimatedSize = SAFE_INNER_WIDTH_PX / (maxLineUnits * MONO_CHAR_WIDTH_RATIO)\n\n  return Number(Math.max(MIN_FONT_SIZE, Math.min(BASE_FONT_SIZE, estimatedSize)).toFixed(2))\n}\n\nconst enhanceCodeLayout = (html, options = {}) => {\n  if (!html) return ''\n  const preFontScale = Number(options.preFontScale || 1)\n  const allowHorizontalScroll = Boolean(options.allowHorizontalScroll)\n  let output = applyInlineStyle(\n    html,\n    'code',\n    'font-size:13px;padding:2px 6px;background:#f1f5f9;border-radius:6px;color:#0f172a;font-family:Menlo,Consolas,monospace;'\n  )\n\n  output = output.replace(/<pre[\\s\\S]*?<\\/pre>/gi, (codeBlock) => {\n    // 放大并允许横滑时，不再强制压缩字体，避免图表依然过小。\n    const baseFontSize = allowHorizontalScroll ? 13 : getPreBlockScaleFontSize(codeBlock)\n    const preFontSize = Number(Math.max(5, Math.min(18, baseFontSize * preFontScale)).toFixed(2))\n    let scaledPre = applyInlineStyle(\n      codeBlock,\n      'pre',\n      `margin:0;background:transparent;color:#e2e8f0;white-space:pre;word-break:normal;overflow-wrap:normal;font-size:${preFontSize}px;line-height:1.45;display:block;`\n    )\n\n    // 代码块中的 code 标签不能带 inline code padding，否则会把整块撑宽后被裁切。\n    scaledPre = scaledPre.replace(\n      /<code([^>]*)>/gi,\n      '<code$1 style=\"font-size:inherit;padding:0;background:transparent;color:inherit;font-family:Menlo,Consolas,monospace;white-space:inherit;\">'\n    )\n\n    const overflowStyle = allowHorizontalScroll\n      ? 'overflow-x:auto;overflow-y:hidden;-webkit-overflow-scrolling:touch;'\n      : 'overflow:hidden;'\n    return `<div style=\"margin:14px 0;border-radius:10px;${overflowStyle}background:#0f172a;padding:12px 14px;max-width:100%;\">${scaledPre}</div>`\n  })\n\n  return output\n}\n\nconst enhanceImageLayout = (html) => {\n  if (!html) return ''\n  return applyInlineStyle(\n    html,\n    'img',\n    'max-width:100%;width:auto;height:auto;display:block;margin:14px auto;border-radius:8px;'\n  )\n}\n\nconst enhanceTableLayout = (html, options = {}) => {\n  if (!html) return ''\n  const tableFontScale = Number(options.tableFontScale || 1)\n  const allowHorizontalScroll = Boolean(options.allowHorizontalScroll)\n  const tableFontSize = Number(Math.max(8, Math.min(18, 12.5 * tableFontScale)).toFixed(2))\n\n  return html.replace(/<table[\\s\\S]*?<\\/table>/gi, (tableHtml) => {\n    let enhanced = applyInlineStyle(\n      tableHtml,\n      'table',\n      `width:100%;max-width:100%;border-collapse:collapse;table-layout:auto;background:#ffffff;font-size:${tableFontSize}px;`\n    )\n\n    enhanced = applyInlineStyle(\n      enhanced,\n      'th',\n      'border:1px solid #e2e8f0;padding:8px 10px;font-weight:600;text-align:left;color:#0f172a;background:#f8fafc;white-space:nowrap;'\n    )\n\n    enhanced = applyInlineStyle(\n      enhanced,\n      'td',\n      'border:1px solid #e2e8f0;padding:8px 10px;line-height:1.6;color:#1f2937;white-space:nowrap;'\n    )\n\n    const overflowStyle = allowHorizontalScroll\n      ? 'overflow-x:auto;overflow-y:hidden;-webkit-overflow-scrolling:touch;'\n      : 'overflow:hidden;'\n    return `<div style=\"max-width:100%;${overflowStyle}margin:12px 0;border-radius:10px;border:1px solid #e2e8f0;\">${enhanced}</div>`\n  })\n}\n\nconst tokenizeMathExpressions = (text) => {\n  const tokens = []\n  let working = text.replace(/\\\\\\$/g, ESCAPED_DOLLAR_TOKEN)\n\n  working = working.replace(/\\$\\$([\\s\\S]+?)\\$\\$/g, (match, formula) => {\n    const token = `@@ESSAY_MATH_BLOCK_${tokens.length}@@`\n    tokens.push({ token, formula, displayMode: true })\n    return token\n  })\n\n  working = working.replace(/\\$([^\\n$]+?)\\$/g, (match, formula) => {\n    const token = `@@ESSAY_MATH_INLINE_${tokens.length}@@`\n    tokens.push({ token, formula, displayMode: false })\n    return token\n  })\n\n  return { text: working, tokens }\n}\n\nconst restoreMathExpressions = (html, tokens) => {\n  let output = html\n  tokens.forEach(({ token, formula, displayMode }) => {\n    let rendered = ''\n    try {\n      rendered = katex.renderToString(formula.trim(), {\n        throwOnError: false,\n        displayMode,\n        strict: 'ignore'\n      })\n    } catch (error) {\n      rendered = formula\n    }\n    output = output.split(token).join(rendered)\n  })\n\n  return output.replace(new RegExp(ESCAPED_DOLLAR_TOKEN, 'g'), '$')\n}\n\nconst normalizeAssetUrl = (url, baseOrigin = '') => {\n  const text = String(url || '').trim()\n  if (!text) return ''\n  if (/^https?:\\/\\//i.test(text)) return text\n  if (/^\\/\\//.test(text)) return `https:${text}`\n  if (/^data:/i.test(text)) return text\n  if (!baseOrigin) return text\n  return `${baseOrigin}${text.startsWith('/') ? '' : '/'}${text}`\n}\n\nconst parseMarkdownImageLink = (rawValue = '') => {\n  const value = String(rawValue || '').trim()\n  if (!value) return ''\n  const withoutTitle = value.split(/\\s+/)[0] || ''\n  return withoutTitle.replace(/^<|>$/g, '')\n}\n\nexport const extractEssayImageUrls = (markdownText, baseOrigin = '') => {\n  if (!markdownText || typeof markdownText !== 'string') return []\n\n  const urls = []\n  const markdownImageRegex = /!\\[[^\\]]*]\\(([^)]+)\\)/g\n  const htmlImageRegex = /<img[^>]+src=([\"'])(.*?)\\1/gi\n\n  let match = null\n  while ((match = markdownImageRegex.exec(markdownText)) !== null) {\n    const rawUrl = parseMarkdownImageLink(match[1])\n    const normalized = normalizeAssetUrl(rawUrl, baseOrigin)\n    if (normalized) urls.push(normalized)\n  }\n\n  while ((match = htmlImageRegex.exec(markdownText)) !== null) {\n    const normalized = normalizeAssetUrl(match[2], baseOrigin)\n    if (normalized) urls.push(normalized)\n  }\n\n  return Array.from(new Set(urls))\n}\n\nexport const parseEssayMarkdown = (markdownText, options = {}) => {\n  if (!markdownText || typeof markdownText !== 'string') return ''\n\n  const { text: withMathToken, tokens } = tokenizeMathExpressions(markdownText)\n  const renderedHtml = markdown.render(withMathToken)\n  const sanitizedHtml = stripImageSizeAttributes(sanitizeRenderedHtml(renderedHtml))\n  const styledHtml = enhanceCodeLayout(\n    enhanceTableLayout(\n      enhanceImageLayout(\n        enhanceTypography(sanitizedHtml)\n      ),\n      options\n    ),\n    options\n  )\n\n  return restoreMathExpressions(styledHtml, tokens)\n}\r\n"],"names":["MarkdownIt","katex"],"mappings":"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"}