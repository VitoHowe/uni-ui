{"version":3,"file":"AuthGuard.js","sources":["components/AuthGuard.vue","../../HBuilderX/plugins/uniapp-cli-vite/uniComponent:/RTovcGVyc29uYWwvdW5pLXVpL2NvbXBvbmVudHMvQXV0aEd1YXJkLnZ1ZQ"],"sourcesContent":["<template>\r\n  <view class=\"auth-guard-container\">\r\n    <!-- 已登录状态：显示受保护的内容 -->\r\n    <slot v-if=\"authStore.isAuthenticated\" />\r\n    \r\n    <!-- 未登录状态：显示登录引导 -->\r\n    <view v-else class=\"login-guide\">\r\n      <!-- 登录引导卡片 -->\r\n      <view class=\"guide-card\">\r\n        <view class=\"guide-icon\">\r\n          <uni-icons type=\"locked\" size=\"48\" color=\"#007AFF\" />\r\n        </view>\r\n        \r\n        <view class=\"guide-content\">\r\n          <text class=\"guide-title\">{{ title || '需要登录' }}</text>\r\n          <text class=\"guide-message\">{{ message || '请登录后查看完整功能' }}</text>\r\n        </view>\r\n        \r\n        <view class=\"guide-actions\">\r\n          <button class=\"login-btn\" @click=\"goToLogin\">\r\n            <uni-icons type=\"person\" size=\"18\" color=\"#fff\" style=\"margin-right: 8rpx;\" />\r\n            立即登录\r\n          </button>\r\n          \r\n          <button v-if=\"showGuestOption\" class=\"guest-btn\" @click=\"handleGuestAccess\">\r\n            暂不登录\r\n          </button>\r\n        </view>\r\n      </view>\r\n      \r\n      <!-- 功能预览区域（可选） -->\r\n      <view v-if=\"showPreview\" class=\"preview-area\">\r\n        <view class=\"preview-header\">\r\n          <text class=\"preview-title\">功能预览</text>\r\n        </view>\r\n        <view class=\"preview-content\">\r\n          <slot name=\"preview\">\r\n            <view class=\"preview-item\">\r\n              <uni-icons type=\"checkmarkempty\" size=\"16\" color=\"#28a745\" />\r\n              <text>个性化学习推荐</text>\r\n            </view>\r\n            <view class=\"preview-item\">\r\n              <uni-icons type=\"checkmarkempty\" size=\"16\" color=\"#28a745\" />\r\n              <text>学习进度同步</text>\r\n            </view>\r\n            <view class=\"preview-item\">\r\n              <uni-icons type=\"checkmarkempty\" size=\"16\" color=\"#28a745\" />\r\n              <text>文件上传与管理</text>\r\n            </view>\r\n          </slot>\r\n        </view>\r\n      </view>\r\n    </view>\r\n  </view>\r\n</template>\r\n\r\n<script setup>\r\nimport { computed } from 'vue'\r\nimport { useAuthStore } from '@/stores/auth.js'\r\nimport { RouteGuard } from '@/utils/auth.js'\r\n\r\n// Props\r\nconst props = defineProps({\r\n  // 标题文本\r\n  title: {\r\n    type: String,\r\n    default: '需要登录'\r\n  },\r\n  \r\n  // 提示消息\r\n  message: {\r\n    type: String,\r\n    default: '请登录后查看完整功能'\r\n  },\r\n  \r\n  // 是否显示游客访问选项\r\n  showGuestOption: {\r\n    type: Boolean,\r\n    default: false\r\n  },\r\n  \r\n  // 是否显示功能预览\r\n  showPreview: {\r\n    type: Boolean,\r\n    default: false\r\n  },\r\n  \r\n  // 当前页面路径（用于登录后返回）\r\n  currentPath: {\r\n    type: String,\r\n    default: ''\r\n  },\r\n  \r\n  // 自动重定向到登录页（而不是显示引导）\r\n  autoRedirect: {\r\n    type: Boolean,\r\n    default: false\r\n  }\r\n})\r\n\r\n// Emits\r\nconst emit = defineEmits(['guestAccess'])\r\n\r\n// 认证store\r\nconst authStore = useAuthStore()\r\n\r\n// 计算属性\r\nconst shouldRedirect = computed(() => {\r\n  return props.autoRedirect && !authStore.isAuthenticated\r\n})\r\n\r\n// 跳转到登录页面\r\nconst goToLogin = () => {\r\n  // 保存当前路径\r\n  if (props.currentPath) {\r\n    RouteGuard.saveReturnPath(props.currentPath)\r\n  } else {\r\n    // 尝试获取当前页面路径\r\n    const pages = getCurrentPages()\r\n    if (pages.length > 0) {\r\n      const currentPage = pages[pages.length - 1]\r\n      const path = `/${currentPage.route}`\r\n      RouteGuard.saveReturnPath(path)\r\n    }\r\n  }\r\n  \r\n  // 跳转到登录页面\r\n  uni.navigateTo({\r\n    url: '/pages/login/login'\r\n  })\r\n}\r\n\r\n// 处理游客访问\r\nconst handleGuestAccess = () => {\r\n  emit('guestAccess')\r\n}\r\n\r\n// 如果设置了自动重定向，检查登录状态\r\nif (shouldRedirect.value) {\r\n  goToLogin()\r\n}\r\n</script>\r\n\r\n<style lang=\"scss\" scoped>\r\n.auth-guard-container {\r\n  width: 100%;\r\n  height: 100%;\r\n}\r\n\r\n.login-guide {\r\n  display: flex;\r\n  flex-direction: column;\r\n  align-items: center;\r\n  justify-content: center;\r\n  min-height: 60vh;\r\n  padding: 40rpx;\r\n}\r\n\r\n.guide-card {\r\n  background: white;\r\n  border-radius: 24rpx;\r\n  padding: 60rpx 40rpx;\r\n  width: 100%;\r\n  max-width: 600rpx;\r\n  text-align: center;\r\n  box-shadow: 0 8rpx 32rpx rgba(0, 0, 0, 0.08);\r\n}\r\n\r\n.guide-icon {\r\n  margin-bottom: 30rpx;\r\n}\r\n\r\n.guide-content {\r\n  margin-bottom: 50rpx;\r\n  \r\n  .guide-title {\r\n    display: block;\r\n    font-size: 36rpx;\r\n    font-weight: 600;\r\n    color: #333;\r\n    margin-bottom: 20rpx;\r\n  }\r\n  \r\n  .guide-message {\r\n    display: block;\r\n    font-size: 28rpx;\r\n    color: #666;\r\n    line-height: 1.5;\r\n  }\r\n}\r\n\r\n.guide-actions {\r\n  display: flex;\r\n  flex-direction: column;\r\n  gap: 20rpx;\r\n  \r\n  .login-btn {\r\n    height: 88rpx;\r\n    background: linear-gradient(135deg, #007AFF 0%, #0056CC 100%);\r\n    color: white;\r\n    border: none;\r\n    border-radius: 44rpx;\r\n    font-size: 32rpx;\r\n    font-weight: 600;\r\n    display: flex;\r\n    align-items: center;\r\n    justify-content: center;\r\n    box-shadow: 0 8rpx 24rpx rgba(0, 122, 255, 0.3);\r\n    transition: all 0.3s ease;\r\n    \r\n    &:active {\r\n      transform: translateY(2rpx);\r\n      box-shadow: 0 4rpx 12rpx rgba(0, 122, 255, 0.4);\r\n    }\r\n  }\r\n  \r\n  .guest-btn {\r\n    height: 80rpx;\r\n    background: transparent;\r\n    color: #666;\r\n    border: 2rpx solid #e0e0e0;\r\n    border-radius: 40rpx;\r\n    font-size: 28rpx;\r\n    \r\n    &:active {\r\n      background: #f5f5f5;\r\n    }\r\n  }\r\n}\r\n\r\n.preview-area {\r\n  margin-top: 40rpx;\r\n  background: white;\r\n  border-radius: 20rpx;\r\n  padding: 40rpx;\r\n  width: 100%;\r\n  max-width: 600rpx;\r\n  box-shadow: 0 4rpx 20rpx rgba(0, 0, 0, 0.06);\r\n}\r\n\r\n.preview-header {\r\n  margin-bottom: 30rpx;\r\n  text-align: center;\r\n  \r\n  .preview-title {\r\n    font-size: 30rpx;\r\n    font-weight: 600;\r\n    color: #333;\r\n  }\r\n}\r\n\r\n.preview-content {\r\n  .preview-item {\r\n    display: flex;\r\n    align-items: center;\r\n    padding: 15rpx 0;\r\n    font-size: 26rpx;\r\n    color: #666;\r\n    \r\n    uni-icons {\r\n      margin-right: 15rpx;\r\n    }\r\n  }\r\n}\r\n\r\n// 响应式设计\r\n@media screen and (max-width: 750rpx) {\r\n  .guide-card {\r\n    margin: 0 20rpx;\r\n    padding: 40rpx 30rpx;\r\n  }\r\n  \r\n  .preview-area {\r\n    margin: 30rpx 20rpx 0;\r\n    padding: 30rpx;\r\n  }\r\n}\r\n</style>\r\n","import Component from 'E:/personal/uni-ui/components/AuthGuard.vue'\nwx.createComponent(Component)"],"names":["useAuthStore","computed","RouteGuard","uni"],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AA8DA,UAAM,QAAQ;AAuCd,UAAM,OAAO;AAGb,UAAM,YAAYA,YAAAA,aAAc;AAGhC,UAAM,iBAAiBC,cAAQ,SAAC,MAAM;AACpC,aAAO,MAAM,gBAAgB,CAAC,UAAU;AAAA,IAC1C,CAAC;AAGD,UAAM,YAAY,MAAM;AAEtB,UAAI,MAAM,aAAa;AACrBC,8BAAW,eAAe,MAAM,WAAW;AAAA,MAC/C,OAAS;AAEL,cAAM,QAAQ,gBAAiB;AAC/B,YAAI,MAAM,SAAS,GAAG;AACpB,gBAAM,cAAc,MAAM,MAAM,SAAS,CAAC;AAC1C,gBAAM,OAAO,IAAI,YAAY,KAAK;AAClCA,qBAAU,WAAC,eAAe,IAAI;AAAA,QAC/B;AAAA,MACF;AAGDC,oBAAAA,MAAI,WAAW;AAAA,QACb,KAAK;AAAA,MACT,CAAG;AAAA,IACH;AAGA,UAAM,oBAAoB,MAAM;AAC9B,WAAK,aAAa;AAAA,IACpB;AAGA,QAAI,eAAe,OAAO;AACxB,gBAAW;AAAA,IACb;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AC3IA,GAAG,gBAAgB,SAAS;"}