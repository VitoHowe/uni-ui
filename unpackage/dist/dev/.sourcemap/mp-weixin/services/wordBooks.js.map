{"version":3,"file":"wordBooks.js","sources":["services/wordBooks.js"],"sourcesContent":["import { get } from '@/utils/request.js'\nimport { API_ENDPOINTS } from '@/utils/constants.js'\n\nconst normalizeBook = (book) => ({\n  id: book.id,\n  name: book.name,\n  description: book.description,\n  language: book.language,\n  totalWords: book.total_words,\n  creatorId: book.created_by,\n  createdAt: book.created_at,\n  updatedAt: book.updated_at,\n  source: {\n    filename: book.source_filename,\n    storedPath: book.stored_path,\n    size: book.source_size\n  }\n})\n\nconst normalizeWord = (bookId, bookName, word) => {\n  const fallbackEnglish = word.word || word.extra?.english || ''\n  const fallbackChinese = word.translation || word.extra?.chinese || ''\n  return {\n    id: word.id ?? `${bookId}-${word.order_index}`,\n    bookId,\n    bookName,\n    english: fallbackEnglish,\n    chinese: fallbackChinese,\n    phonetic: word.phonetic || '',\n    definition: word.definition || '',\n    example: word.example_sentence || '',\n    partOfSpeech: word.part_of_speech || '',\n    tags: word.tags || [],\n    order: word.order_index ?? 0,\n    raw: word\n  }\n}\n\nexport const fetchWordBooks = async (params = {}) => {\n  const data = await get(API_ENDPOINTS.WORD_BOOKS.LIST, params)\n  const books = (data?.books || []).map(normalizeBook)\n  return {\n    books,\n    total: data?.total ?? books.length,\n    pagination: data?.pagination || {\n      page: params.page || 1,\n      limit: params.limit || books.length || 10,\n      total: data?.total ?? books.length,\n      totalPages: data?.pagination?.totalPages || 1\n    }\n  }\n}\n\nexport const fetchWordBookWords = async (bookId) => {\n  if (!bookId) {\n    throw new Error('bookId is required to load words')\n  }\n  const data = await get(API_ENDPOINTS.WORD_BOOKS.WORDS(bookId))\n  const bookName = data?.book?.name || ''\n  const words = (data?.words || []).map((item) => normalizeWord(bookId, bookName, item))\n  return {\n    book: normalizeBook(data?.book || { id: bookId, name: bookName }),\n    words,\n    total: data?.total ?? words.length\n  }\n}\n\nexport const findWordInBooks = (books, bookId) => {\n  return books.find((item) => item.id === bookId) || null\n}\n"],"names":["get","API_ENDPOINTS"],"mappings":";;;AAGA,MAAM,gBAAgB,CAAC,UAAU;AAAA,EAC/B,IAAI,KAAK;AAAA,EACT,MAAM,KAAK;AAAA,EACX,aAAa,KAAK;AAAA,EAClB,UAAU,KAAK;AAAA,EACf,YAAY,KAAK;AAAA,EACjB,WAAW,KAAK;AAAA,EAChB,WAAW,KAAK;AAAA,EAChB,WAAW,KAAK;AAAA,EAChB,QAAQ;AAAA,IACN,UAAU,KAAK;AAAA,IACf,YAAY,KAAK;AAAA,IACjB,MAAM,KAAK;AAAA,EACZ;AACH;AAEA,MAAM,gBAAgB,CAAC,QAAQ,UAAU,SAAS;;AAChD,QAAM,kBAAkB,KAAK,UAAQ,UAAK,UAAL,mBAAY,YAAW;AAC5D,QAAM,kBAAkB,KAAK,iBAAe,UAAK,UAAL,mBAAY,YAAW;AACnE,SAAO;AAAA,IACL,IAAI,KAAK,MAAM,GAAG,MAAM,IAAI,KAAK,WAAW;AAAA,IAC5C;AAAA,IACA;AAAA,IACA,SAAS;AAAA,IACT,SAAS;AAAA,IACT,UAAU,KAAK,YAAY;AAAA,IAC3B,YAAY,KAAK,cAAc;AAAA,IAC/B,SAAS,KAAK,oBAAoB;AAAA,IAClC,cAAc,KAAK,kBAAkB;AAAA,IACrC,MAAM,KAAK,QAAQ,CAAE;AAAA,IACrB,OAAO,KAAK,eAAe;AAAA,IAC3B,KAAK;AAAA,EACN;AACH;AAEY,MAAC,iBAAiB,OAAO,SAAS,OAAO;;AACnD,QAAM,OAAO,MAAMA,cAAG,IAACC,gBAAa,cAAC,WAAW,MAAM,MAAM;AAC5D,QAAM,UAAS,6BAAM,UAAS,CAAE,GAAE,IAAI,aAAa;AACnD,SAAO;AAAA,IACL;AAAA,IACA,QAAO,6BAAM,UAAS,MAAM;AAAA,IAC5B,aAAY,6BAAM,eAAc;AAAA,MAC9B,MAAM,OAAO,QAAQ;AAAA,MACrB,OAAO,OAAO,SAAS,MAAM,UAAU;AAAA,MACvC,QAAO,6BAAM,UAAS,MAAM;AAAA,MAC5B,cAAY,kCAAM,eAAN,mBAAkB,eAAc;AAAA,IAC7C;AAAA,EACF;AACH;AAEY,MAAC,qBAAqB,OAAO,WAAW;;AAClD,MAAI,CAAC,QAAQ;AACX,UAAM,IAAI,MAAM,kCAAkC;AAAA,EACnD;AACD,QAAM,OAAO,MAAMD,kBAAIC,gBAAAA,cAAc,WAAW,MAAM,MAAM,CAAC;AAC7D,QAAM,aAAW,kCAAM,SAAN,mBAAY,SAAQ;AACrC,QAAM,UAAS,6BAAM,UAAS,CAAA,GAAI,IAAI,CAAC,SAAS,cAAc,QAAQ,UAAU,IAAI,CAAC;AACrF,SAAO;AAAA,IACL,MAAM,eAAc,6BAAM,SAAQ,EAAE,IAAI,QAAQ,MAAM,UAAU;AAAA,IAChE;AAAA,IACA,QAAO,6BAAM,UAAS,MAAM;AAAA,EAC7B;AACH;;;"}