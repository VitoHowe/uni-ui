"use strict";const e=require("../../common/vendor.js"),o=require("../../common/assets.js"),n=require("../../stores/auth.js");require("../../utils/constants.js");const l=require("../../utils/navigationGuard.js");if(!Array){e.resolveComponent("uni-icons")()}Math;const i={__name:"login",setup(i){const t=n.useAuthStore(),s=e.ref("1.0.0"),a=e.ref(!1),c=e.ref("ÁôªÂΩï‰∏≠..."),r=e.reactive([{title:"Êô∫ËÉΩÂ≠¶‰π†",description:"‰∏™ÊÄßÂåñÂ≠¶‰π†Ë∑ØÂæÑÊé®Ëçê",icon:"gear",color:"#007AFF"},{title:"È¢òÂ∫ìÁªÉ‰π†",description:"Êµ∑ÈáèÈ¢òÁõÆÔºåÁ≤æÂáÜÁªÉ‰π†",icon:"compose",color:"#28a745"},{title:"ËøõÂ∫¶ÂêåÊ≠•",description:"Â§öÁ´ØÊï∞ÊçÆÂÆûÊó∂ÂêåÊ≠•",icon:"cloud-upload",color:"#ffc107"},{title:"Êñá‰ª∂‰∏ä‰º†",description:"ÊîØÊåÅÊñáÊ°£ÊâπÈáèËß£Êûê",icon:"folder",color:"#17a2b8"}]),u=e.computed((()=>!t.loading.login&&!a.value)),d=()=>{console.warn("LogoÂä†ËΩΩÂ§±Ë¥•Ôºå‰ΩøÁî®ÈªòËÆ§ÂõæÊ†á")},g=async()=>{if(console.log("üîò Áî®Êà∑ÁÇπÂáªÂæÆ‰ø°ÁôªÂΩïÊåâÈíÆ"),u.value)try{a.value=!0,c.value="Ê≠£Âú®Ëé∑ÂèñÂæÆ‰ø°ÊéàÊùÉ...",console.log("üöÄ ÂºÄÂßãÂæÆ‰ø°ÁôªÂΩïÊµÅÁ®ã"),await t.loginWithWechat(!0,!1),c.value="ÁôªÂΩïÊàêÂäüÔºåË∑≥ËΩ¨‰∏≠...",console.log("üéâ ÂæÆ‰ø°ÁôªÂΩïÊàêÂäüÔºåÂáÜÂ§áË∑≥ËΩ¨"),await p()}catch(o){console.error("‚ùå ÂæÆ‰ø°ÁôªÂΩïÂ§±Ë¥•:",o),t.isCodeRelatedError&&t.isCodeRelatedError(o)?(console.log("üîÑ Ê£ÄÊµãÂà∞codeÈîôËØØÔºåÊòæÁ§∫ÈáçËØïÈÄâÈ°π"),e.index.showModal({title:"ÁôªÂΩïÂ§±Ë¥•",content:"ÂæÆ‰ø°ÊéàÊùÉÁ†ÅÂ∑≤Â§±ÊïàÔºåÊòØÂê¶ÈáçÊñ∞Â∞ùËØïÁôªÂΩïÔºü",confirmText:"ÈáçËØïÁôªÂΩï",cancelText:"Á®çÂêéÂÜçËØï",success:async e=>{e.confirm&&setTimeout((()=>{g()}),500)}})):v(o)}finally{a.value=!1}else console.warn("‚ö†Ô∏è ÂΩìÂâçÊ≠£Âú®ÁôªÂΩï‰∏≠ÔºåÂøΩÁï•ÈáçÂ§çÁÇπÂáª")},f=async e=>{if(console.log("Ëé∑ÂèñÁî®Êà∑‰ø°ÊÅØ:",e.detail),"getUserInfo:ok"!==e.detail.errMsg)if(console.log("üîÑ Áî®Êà∑ÊãíÁªùÊéàÊùÉÔºåÂ∞ùËØïÂü∫Á°ÄÁôªÂΩïÔºà‰ΩøÁî®Êñ∞codeÔºâ"),u.value)try{a.value=!0,c.value="Ê≠£Âú®ËøõË°åÂü∫Á°ÄÁôªÂΩï...",await t.loginWithWechat(!1,!0),c.value="ÁôªÂΩïÊàêÂäüÔºåË∑≥ËΩ¨‰∏≠...",await p()}catch(o){console.error("Âü∫Á°ÄÁôªÂΩïÂ§±Ë¥•:",o),v(o)}finally{a.value=!1}else console.warn("‚ö†Ô∏è ÂΩìÂâçÊ≠£Âú®ÁôªÂΩï‰∏≠ÔºåÂøΩÁï•ÈáçÂ§çËØ∑Ê±Ç")},m=()=>{e.index.showModal({title:"Ê∏∏ÂÆ¢Ê®°Âºè",content:"Ê∏∏ÂÆ¢Ê®°Âºè‰∏ãÈÉ®ÂàÜÂäüËÉΩÂèóÈôêÔºåÂª∫ËÆÆÁôªÂΩïÂêé‰ΩøÁî®ÂÆåÊï¥ÂäüËÉΩ„ÄÇÁ°ÆÂÆö‰ª•Ê∏∏ÂÆ¢Ë∫´‰ªΩÊµèËßàÂêóÔºü",confirmText:"Á°ÆÂÆöÊµèËßà",cancelText:"ËøîÂõûÁôªÂΩï",success:o=>{o.confirm&&e.index.reLaunch({url:"/pages/index/index"})}})},p=async()=>{console.log("ÁôªÂΩïÊàêÂäüÔºåÂ§ÑÁêÜË∑≥ËΩ¨ÈÄªËæë"),setTimeout((()=>{l.NavigationGuard.handleLoginSuccess()}),1e3)},v=o=>{let n="ÁôªÂΩïÂ§±Ë¥•",l=o.message||"ÁôªÂΩïËøáÁ®ã‰∏≠ÂèëÁîüÊú™Áü•ÈîôËØØÔºåËØ∑Á®çÂêéÈáçËØï";o.message&&o.message.includes("ÂèñÊ∂à")?(n="ÁôªÂΩïÂèñÊ∂à",l="ÊÇ®ÂèñÊ∂à‰∫ÜÂæÆ‰ø°ÊéàÊùÉ„ÄÇÊÇ®ÂèØ‰ª•ÈÄâÊã©Ê∏∏ÂÆ¢ÊµèËßàÔºåÊàñÁ®çÂêéÈáçÊñ∞ÁôªÂΩïËé∑ÂèñÂÆåÊï¥ÂäüËÉΩ„ÄÇ"):o.message&&o.message.includes("ÁΩëÁªú")?(n="ÁΩëÁªúÈîôËØØ",l="ÁΩëÁªúËøûÊé•ÂºÇÂ∏∏ÔºåËØ∑Ê£ÄÊü•ÁΩëÁªúËÆæÁΩÆÂêéÈáçËØï„ÄÇ"):o.message&&o.message.includes("ÊúçÂä°Âô®")&&(n="ÊúçÂä°ÂºÇÂ∏∏",l="ÊúçÂä°Âô®ÊöÇÊó∂Êó†Ê≥ïÂìçÂ∫îÔºåËØ∑Á®çÂêéÈáçËØï„ÄÇ"),e.index.showModal({title:n,content:l,showCancel:!1,confirmText:"Áü•ÈÅì‰∫Ü"})},h=()=>{e.index.showModal({title:"Áî®Êà∑ÂçèËÆÆ",content:"ËøôÈáåÂ∫îËØ•ÊòæÁ§∫ÂÆåÊï¥ÁöÑÁî®Êà∑ÂçèËÆÆÂÜÖÂÆπ...",showCancel:!1,confirmText:"Áü•ÈÅì‰∫Ü"})},x=()=>{e.index.showModal({title:"ÈöêÁßÅÊîøÁ≠ñ",content:"ËøôÈáåÂ∫îËØ•ÊòæÁ§∫ÂÆåÊï¥ÁöÑÈöêÁßÅÊîøÁ≠ñÂÜÖÂÆπ...",showCancel:!1,confirmText:"Áü•ÈÅì‰∫Ü"})};return e.onMounted((()=>{t.isAuthenticated&&(console.log("Áî®Êà∑Â∑≤ÁôªÂΩïÔºåË∑≥ËΩ¨Ëá≥È¶ñÈ°µ"),e.index.reLaunch({url:"/pages/index/index"}))})),(n,l)=>e.e({a:o._imports_0,b:e.o(d),c:e.f(r,((o,n,l)=>({a:"40396a21-0-"+l,b:e.p({type:o.icon,size:"24",color:"#fff"}),c:o.color,d:e.t(o.title),e:e.t(o.description),f:n}))),d:!e.unref(t).loading.login&&!a.value},e.unref(t).loading.login||a.value?{f:e.p({type:"spinner-cycle",size:"20",color:"#fff"})}:{e:e.p({type:"weixin",size:"20",color:"#fff"})},{g:e.t(a.value?c.value||"Â§ÑÁêÜ‰∏≠...":t.loading.login?"ÁôªÂΩï‰∏≠...":"ÂæÆ‰ø°‰∏ÄÈîÆÁôªÂΩï"),h:e.unref(t).loading.login?1:"",i:e.unref(t).loading.login||a.value,j:e.o(g),k:e.o(f),l:e.unref(t).loading.login,m:e.o(m),n:e.o(h),o:e.o(x),p:e.t(s.value),q:a.value},a.value?{r:e.p({type:"spinner-cycle",size:"40",color:"#007AFF"}),s:e.t(c.value)}:{})}},t=e._export_sfc(i,[["__scopeId","data-v-40396a21"]]);wx.createPage(t);
