"use strict";const e=require("../../../common/vendor.js"),o=require("../../../utils/request.js"),n=require("../../utils/subject.js");if(!Array){(e.resolveComponent("uni-icons")+e.resolveComponent("uni-section")+e.resolveComponent("uni-fab"))()}Math||((()=>"../../../uni_modules/uni-icons/components/uni-icons/uni-icons.js")+(()=>"../../../uni_modules/uni-section/components/uni-section/uni-section.js")+(()=>"../../../uni_modules/uni-fab/components/uni-fab/uni-fab.js")+t)();const t=()=>"../../../components/CustomTabBar.js",a={__name:"question",setup(t){const a=e.reactive([{key:"real",name:"真题练习",description:"历年考试真题，贴近实际考试",icon:"fire",color:"#EF4444",count:0},{key:"mock",name:"模拟考试",description:"完整模拟考试，检验学习成果",icon:"calendar",color:"#3B82F6",count:0},{key:"special",name:"专项训练",description:"针对性练习，突破薄弱环节",icon:"gear",color:"#10B981",count:0},{key:"random",name:"随机练习",description:"随机抽取题目，全面复习",icon:"loop",color:"#F59E0B",count:0}]),i=e.ref([]),c=e.ref(n.SubjectStorage.get()),s=e.ref(!1),r=e.ref(0),l=e.ref(!1),u=e=>{c.value=e,n.SubjectStorage.set(e)},d=async()=>{if(c.value&&!l.value){l.value=!0;try{const n=await o.get("/practice/summary",{subjectId:c.value.id},{showLoading:!1}),t=n.mode_counts||{};e=t,a.forEach((o=>{e&&void 0!==e[o.key]&&(o.count=Number(e[o.key])||0)})),r.value=Number(n.wrong_set_count||0)}catch(n){console.error("获取练习统计失败:",n)}finally{l.value=!1}var e}},m=()=>{s.value||(i.value.length?e.index.showActionSheet({itemList:i.value.map((e=>e.name)),success:e=>{const o=i.value[e.tapIndex];o&&(u(o),d())}}):e.index.showToast({title:"暂无可选科目",icon:"none"}))},p=()=>!!c.value||(e.index.showToast({title:"请先选择科目",icon:"none"}),m(),!1),v=()=>{var o,n;if(!p())return;const t=(null==(o=c.value)?void 0:o.id)||0,a=(null==(n=c.value)?void 0:n.name)||"";e.index.navigateTo({url:`/pkg-exam/pages/wrong-set/wrong-set?subjectId=${t}&subjectName=${encodeURIComponent(a)}`})};e.onShow((()=>{const t=n.SubjectStorage.get();t&&(c.value=t),(async()=>{if(!s.value){s.value=!0;try{const e=((await o.get("/subjects")).subjects||[]).map(n.normalizeSubject);if(i.value=e,!c.value&&e.length)return void u(e[0]);if(c.value){const o=e.find((e=>e.id===c.value.id));o?u(o):e.length&&u(e[0])}await d()}catch(t){console.error("获取科目失败:",t),e.index.showToast({title:t.message||"获取科目失败",icon:"none"})}finally{s.value=!1}}})()}));const g=e.reactive({color:"#3B82F6",backgroundColor:"#fff",selectedColor:"#2563EB"}),f=e.reactive([{iconPath:"/static/c1.png",selectedIconPath:"/static/c1.png",text:"快速练习",active:!1}]),b=o=>{p()&&e.index.showToast({title:"开始快速练习",icon:"none"})},j=e=>{console.log("切换到tab:",e)};return(o,n)=>{var t;return{a:e.t((null==(t=c.value)?void 0:t.name)||"请选择科目"),b:e.t(i.value.length?"切换":"加载中"),c:e.p({type:"arrowdown",size:"16",color:"#999"}),d:e.o(m),e:e.f(a,((o,n,t)=>({a:"059d11a2-2-"+t+",059d11a2-1",b:e.p({type:o.icon,size:"22",color:"#fff"}),c:o.color,d:e.t(o.name),e:e.t(o.description),f:e.t(o.count),g:"059d11a2-3-"+t+",059d11a2-1",h:n,i:e.o((n=>(o=>{var n,t;if(!p())return;const a=null==(n=c.value)?void 0:n.id,i=(null==(t=c.value)?void 0:t.name)||"";switch(o.key){case"mock":return void e.index.navigateTo({url:`/pkg-exam/pages/exam-list/exam-list?subjectId=${a}&subjectName=${encodeURIComponent(i)}`});case"real":return void e.index.navigateTo({url:`/pkg-exam/pages/real-exam-list/real-exam-list?subjectId=${a}&subjectName=${encodeURIComponent(i)}`});case"special":return void e.index.navigateTo({url:`/pkg-exam/pages/special-list/special-list?subjectId=${a}&subjectName=${encodeURIComponent(i)}`});case"random":return void e.index.navigateTo({url:`/pkg-exam/pages/exam/exam?mode=random&subjectId=${a}&subjectName=${encodeURIComponent(i)}`});default:e.index.showToast({title:`开始${o.name}`,icon:"none"})}})(o)),n)}))),f:e.p({type:"arrowright",size:"16",color:"#ccc"}),g:e.p({title:"练习模式",type:"line",padding:!0}),h:e.t(r.value),i:e.o(v),j:e.p({type:"closeempty",size:"20",color:"#dc3545"}),k:e.p({type:"arrowright",size:"16",color:"#ccc"}),l:e.o(v),m:e.p({title:"错题集",type:"line",padding:!0}),n:e.o(b),o:e.p({pattern:g,content:f,direction:"vertical"}),p:e.o(j),q:e.p({current:2})}}}},i=e._export_sfc(a,[["__scopeId","data-v-059d11a2"]]);wx.createPage(i);
